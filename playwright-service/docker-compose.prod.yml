# Docker Compose for production (DigitalOcean)
# Connects to existing PostgreSQL instance
# Add this service to your existing docker-compose on the droplet

version: '3.8'

services:
  playwright-service:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: playwright-service
    restart: unless-stopped
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=${DATABASE_URL}  # Use existing PostgreSQL connection string
      - ENCRYPTION_KEY=${ENCRYPTION_KEY}
      - API_KEY=${API_KEY}
      - PLAYWRIGHT_TIMEOUT=30000
      - DOWNLOAD_DIR=/app/downloads
      - SCREENSHOT_DIR=/app/screenshots
      - SESSION_DIR=/app/sessions
      - LOG_LEVEL=INFO
    volumes:
      - playwright_downloads:/app/downloads
      - playwright_screenshots:/app/screenshots
      - playwright_sessions:/app/sessions
    shm_size: '2gb'
    # Uses default docker compose network

volumes:
  playwright_downloads:
  playwright_screenshots:
  playwright_sessions:

